with subq as 
(
select B.name, B.ID as 'st_id', C.title, D.ID as 'in_id'
from takes A natural join student B natural join course C
left join teaches D on (A.course_id, A.sec_id, A.semester, A.year) = (D.course_id, D.sec_id, D.semester, D.year)
)
select name, title from subq, advisor 
where (st_id, in_id) = (s_ID, i_ID);